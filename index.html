<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>游댠 Exclusive Dating Access 游댠</title>
    <style>
        body { text-align: center; font-family: Arial, sans-serif; background: black; color: white; }
        .container { max-width: 400px; margin: 50px auto; padding: 20px; background: rgba(0, 0, 0, 0.8); border-radius: 10px; }
        .cta-button { display: inline-block; padding: 15px 20px; background: red; color: white; text-decoration: none; font-size: 20px; font-weight: bold; border-radius: 5px; margin-top: 20px; cursor: pointer; }
        input { padding: 10px; width: 90%; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>游댠 Exclusive Access for 18+ Only 游댠</h1>
        <p>Enter your email to continue browsing:</p>
        <input type="email" id="email" placeholder="Enter your email" required>
        <button class="cta-button" onclick="submitEmail()">Get Access</button>
    </div>

    <script>
        async function submitEmail() {
            const email = document.getElementById("email").value;

            // Verificar si el email est치 vac칤o
            if (!email) {
                alert("You must enter a valid email to continue!");
                return;  // No continuar si no hay correo
            }

            // Validar que el correo tenga un formato v치lido
            const emailRegex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;
            if (!emailRegex.test(email)) {
                alert("Please enter a valid email address!");
                return;  // No continuar si el correo no tiene el formato correcto
            }

            try {
                // Enviar el email al servidor
                const response = await fetch("https://ivewhjsyfwmxxyfmoakw.supabase.co/rest/v1/emails", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "apikey": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml2ZXdoanN5ZndteHh5Zm1vYWt3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzg4MzczNjksImV4cCI6MjA1NDQxMzM2OX0.sXwkKkGlNWvH40SuDkyj2WegeghAds6-Kp0XHJWv_0Y", 
                        "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml2ZXdoanN5ZndteHh5Zm1vYWt3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzg4MzczNjksImV4cCI6MjA1NDQxMzM2OX0.sXwkKkGlNWvH40SuDkyj2WegeghAds6-Kp0XHJWv_0Y"
                    },
                    body: JSON.stringify({ email })
                });

                const responseText = await response.text();  // Procesamos la respuesta como texto para depuraci칩n

                if (!response.ok) {
                    console.error("Error response:", responseText);  // Mostramos el error en la consola

                    if (responseText.includes("duplicate key value")) {
                        // Si el correo ya existe, solo redirigimos sin mostrar mensaje de error
                        window.location.href = "https://t.slext2.com/341879/7272?bo=2753,2754,2755,2756&popUnder=true&aff_sub5=SF_006OG000004lmDN";
                    } else {
                        // Si hay otro error, redirigimos de todos modos sin mostrar mensaje
                        window.location.href = "https://t.slext2.com/341879/7272?bo=2753,2754,2755,2756&popUnder=true&aff_sub5=SF_006OG000004lmDN";
                    }
                    return;
                }

                // Si la respuesta est치 vac칤a, evitamos parsearla como JSON y solo procedemos con la redirecci칩n
                if (!responseText.trim()) {
                    window.location.href = "https://t.slext2.com/341879/7272?bo=2753,2754,2755,2756&popUnder=true&aff_sub5=SF_006OG000004lmDN";
                    return;
                }

                // Si la respuesta es exitosa, redirigimos al usuario a la oferta
                window.location.href = "https://t.slext2.com/341879/7272?bo=2753,2754,2755,2756&popUnder=true&aff_sub5=SF_006OG000004lmDN";

            } catch (error) {
                console.error("Error submitting email:", error);  // Mostramos el error de la petici칩n en la consola
                window.location.href = "https://t.slext2.com/341879/7272?bo=2753,2754,2755,2756&popUnder=true&aff_sub5=SF_006OG000004lmDN"; // Redirigimos de todos modos
            }
        }
    </script>
</body>
</html>
